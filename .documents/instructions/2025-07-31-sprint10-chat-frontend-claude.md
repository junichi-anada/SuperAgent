# 指示書: Sprint 10 - AIチャットUI実装 (モック)

## 1. 目的
ユーザーがリアルタイムでAIと対話できるチャット画面のUIを、WebSocketを使用して実装する。
**注意:** このタスクはモック環境での実装を対象とします。実際のAI (Ollama) との連携は範囲外です。

## 2. 指示方針
- **技術スタック:** FastAPI (WebSocket), Next.jsを使用すること。
- **参考資料:** プロジェクトの全体像や細かい仕様で迷ったら、必ず `.documents/Project.md` を確認すること。
- **コーディング規約:** PythonはPEP8、JavaScriptはPrettierの標準ルールに従うこと。
- **アウトプット形式:** 作業が完了したら、変更・追加したファイルのパスと、それぞれの作業内容の簡単なサマリーをJSON形式で報告すること。
- **進捗報告:** 以下の作業手順を1つ実行するごとに、「ステップX完了」と簡潔に報告すること。

## 3. 作業手順

### ステップ1: バックエンドWebSocketエンドポイントの実装
- **ファイル:** `backend/routers/chat.py` を修正してください。
- **作業内容:**
    1.  `/ws/{chat_id}` というパスでWebSocket接続を受け付けるエンドポイントを追加してください。
    2.  クライアントからメッセージを受信したら、Sprint 9で実装したロジックを再利用して、ユーザーからのメッセージとAIからのモック返信の両方をDBに保存してください。
    3.  DB保存後、ユーザーからのメッセージとAIからのモック返信の両方を、接続しているクライアントにWebSocket経由で送信してください。

### ステップ2: フロントエンド チャット画面の実装
- **ファイル:** `frontend/pages/chats/[id].js` を新規作成してください。
- **作業内容:**
    1.  画面上部にチャット履歴を表示するエリア、下部にメッセージ入力フォームと送信ボタンを配置してください。
    2.  ページが読み込まれたら、バックエンドの `/ws/{chat_id}` エンドポイントにWebSocket接続を行ってください。
    3.  送信ボタンがクリックされたら、入力されたメッセージをWebSocketでサーバーに送信してください。
    4.  サーバーからWebSocket経由でメッセージを受信したら、チャット履歴エリアにその内容を追加して表示してください。（ユーザー自身のメッセージ、AIからの返信の両方）
    5.  ページ初期表示時には、Sprint 9で作成した `GET /chats/{chat_id}/messages` を呼び出し、過去の履歴を表示してください。

## 4. 完了報告
全ての作業が完了したら、最終的な成果物として、指示方針で定めた通りのJSON報告を行ってください。
